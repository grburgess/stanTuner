# Target amount of density in lower (L) and upper (U) tails
dens_L = 0.01
dens_U = 0.01
# Target lower (L) and upper (U) quantiles
quantile_L = 2
quantile_U = 8.5
# Initial guess of parameters
alpha_guess = 5
beta_guess = 5
temp = paste(
'functions {', '\n',
'  // Differences between inverse Gamma tail probabilities and target probabilities',
#   vector tail_delta(vector y, vector theta, real[] x_r, int[] x_i) {
#     vector[2] deltas;
#     deltas[1] = inv_gamma_cdf(theta[1], exp(y[1]), exp(y[2])) - dens_L;
#     deltas[2] = 1 - inv_gamma_cdf(theta[2], exp(y[1]), exp(y[2])) - dens_U;
#     return deltas;
#   }
# }
sep='')
temp
print(temp)
test = paste('1', '2', '\n', '3')
test
test = paste('1', '2', '\n', '3', sep='')
test
print(test)
test = paste('1', '2', '\n', '3', sep='\n')
test
print(test)
test
temp = paste(
'functions {',
'  // Differences between inverse Gamma tail probabilities and target probabilities',
'  vector tail_delta(vector y, vector theta, real[] x_r, int[] x_i) {',
'    vector[2] deltas;',
'    deltas[1] = inv_gamma_cdf(theta[1], exp(y[1]), exp(y[2])) - ', dens_L, ';',
'    deltas[2] = 1 - inv_gamma_cdf(theta[2], exp(y[1]), exp(y[2])) - ', dens_U, ';',
'    return deltas;',
'  }',
'}',
sep='')
temp
print(temp )
############################################################
# Initial setup
############################################################
library(rstan)
rstan_options(auto_write = FALSE)
options(mc.cores = parallel::detectCores())
util <- new.env()
source('utility.R', local=util)
?ggplot
targets = list(
quantile_L = 0.5,  # LOWER quantile boundary
quantile_U = 0.99, # UPPER quantile boundary
dens_L     = 0.01, # Target amount of density below LOWER quantile boundary
dens_U     = 0.01) # Target amount of density above UPPER quantile boundary
result = util$findParams(dist='beta', targets)
result$params
result$quantiles
util$makeHistogram(result, targets)
targets = list(
quantile_L = 1,    # LOWER quantile boundary
quantile_U = 10,   # UPPER quantile boundary
dens_L     = 0.01, # Target amount of density below LOWER quantile boundary
dens_U     = 0.01) # Target amount of density above UPPER quantile boundary
result = util$findParams(dist='inv_gamma', targets)
result$params
result$quantiles
util$makeHistogram(result, targets)
# ----------------------------------------------------------------------------
# Initial setup
library(rstan)
# Set auto_write to false because I want to always search from scratch
rstan_options(auto_write = FALSE)
options(mc.cores = parallel::detectCores())
util <- new.env()
source('utility.R', local=util)
targets = list(
bound_L = -2,   # LOWER quantile boundary
bound_U = 2,    # UPPER quantile boundary
dens_L  = 0.01, # Target density below LOWER quantile boundary
dens_U  = 0.01) # Target density above UPPER quantile boundary
result = util$tuneParams(distribution='normal', targets)
result$params
result$quantiles
result$histogram
# ----------------------------------------------------------------------------
# Initial setup
library(rstan)
# Set auto_write to false because I want to always search from scratch
rstan_options(auto_write = FALSE)
options(mc.cores = parallel::detectCores())
util <- new.env()
source('utility.R', local=util)
# ----------------------------------------------------------------------------
# Find normal distribution parameters with targets:
# P[x < -2.0] ~ 0.01
# P[x > 2.0] ~ 0.01
targets = list(
bound_L = -2,   # LOWER quantile boundary
bound_U = 2,    # UPPER quantile boundary
dens_L  = 0.01, # Target density below LOWER quantile boundary
dens_U  = 0.01) # Target density above UPPER quantile boundary
distribution='normal'
generateStanCode(distribution, targets)
# Get the parameters (round to nearest 5th decimal space)
fit <- stan(file='./model.stan', iter=1, warmup=0, chains=1,
algorithm="Fixed_param")
params <- extract(fit)
params$lp__ <- NULL
for (i in 1:length(params)) {params[[i]] <- round(params[[i]], 5)}
draws     <- getDraws(distribution, params)
quantiles <- quantile(draws, c(targets$dens_L, 1-targets$dens_U))
draws     <- util$getDraws(distribution, params)
quantiles <- util$quantile(draws, c(targets$dens_L, 1-targets$dens_U))
quantiles <- quantile(draws, c(targets$dens_L, 1-targets$dens_U))
quantiles
draws = draws[which(draws > quantile(draws, 0.001))]
draws = draws[which(draws < quantile(draws, 0.999))]
histogram = ggplot(data.frame(draws), aes(x=draws)) +
geom_histogram(stat_bin(binwidth=30),
fill='#DCBCBC', color='#C79999') +
# Color scheme copied from betanalpha (Thanks Michael!)
geom_vline(xintercept=quantiles,
color=mid, linetype='dashed', size=1) +
theme_bw() +
labs(x='x', y='Count')
?geom_histogram
histogram = ggplot(data.frame(draws), aes(x=draws)) +
geom_histogram(bins=30, fill='#DCBCBC', color='#C79999') +
# Color scheme copied from betanalpha (Thanks Michael!)
geom_vline(xintercept=quantiles,
color=mid, linetype='dashed', size=1) +
theme_bw() +
labs(x='x', y='Count')
histogram = ggplot(data.frame(draws), aes(x=draws)) +
geom_histogram(bins=30, fill='#DCBCBC', color='#C79999') +
geom_vline(xintercept=quantiles,
color='B97C7C', linetype='dashed', size=1) +
# Color scheme copied from betanalpha (Thanks Michael!)
theme_bw() +
labs(x='x', y='Count')
histogram
histogram = ggplot(data.frame(draws), aes(x=draws)) +
geom_histogram(bins=30, fill='#DCBCBC', color='#C79999') +
geom_vline(xintercept=quantiles,
color='#B97C7C', linetype='dashed', size=1) +
# Color scheme copied from betanalpha (Thanks Michael!)
theme_bw() +
labs(x='x', y='Count')
histogram
# ----------------------------------------------------------------------------
# Initial setup
library(rstan)
# Set auto_write to false because I want to always search from scratch
rstan_options(auto_write = FALSE)
options(mc.cores = parallel::detectCores())
util <- new.env()
source('utility.R', local=util)
# ----------------------------------------------------------------------------
# Find normal distribution parameters with targets:
# P[x < -2.0] ~ 0.01
# P[x > 2.0] ~ 0.01
targets = list(
bound_L = -2,   # LOWER quantile boundary
bound_U = 2,    # UPPER quantile boundary
dens_L  = 0.01, # Target density below LOWER quantile boundary
dens_U  = 0.01) # Target density above UPPER quantile boundary
result = util$tuneParams(distribution='normal', targets)
result$params
result$quantiles
result$histogram
