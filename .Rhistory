# Target amount of density in lower (L) and upper (U) tails
dens_L = 0.01
dens_U = 0.01
# Target lower (L) and upper (U) quantiles
quantile_L = 2
quantile_U = 8.5
# Initial guess of parameters
alpha_guess = 5
beta_guess = 5
temp = paste(
'functions {', '\n',
'  // Differences between inverse Gamma tail probabilities and target probabilities',
#   vector tail_delta(vector y, vector theta, real[] x_r, int[] x_i) {
#     vector[2] deltas;
#     deltas[1] = inv_gamma_cdf(theta[1], exp(y[1]), exp(y[2])) - dens_L;
#     deltas[2] = 1 - inv_gamma_cdf(theta[2], exp(y[1]), exp(y[2])) - dens_U;
#     return deltas;
#   }
# }
sep='')
temp
print(temp)
test = paste('1', '2', '\n', '3')
test
test = paste('1', '2', '\n', '3', sep='')
test
print(test)
test = paste('1', '2', '\n', '3', sep='\n')
test
print(test)
test
temp = paste(
'functions {',
'  // Differences between inverse Gamma tail probabilities and target probabilities',
'  vector tail_delta(vector y, vector theta, real[] x_r, int[] x_i) {',
'    vector[2] deltas;',
'    deltas[1] = inv_gamma_cdf(theta[1], exp(y[1]), exp(y[2])) - ', dens_L, ';',
'    deltas[2] = 1 - inv_gamma_cdf(theta[2], exp(y[1]), exp(y[2])) - ', dens_U, ';',
'    return deltas;',
'  }',
'}',
sep='')
temp
print(temp )
############################################################
# Initial setup
############################################################
library(rstan)
rstan_options(auto_write = FALSE)
options(mc.cores = parallel::detectCores())
util <- new.env()
source('utility.R', local=util)
?ggplot
targets = list(
quantile_L = 0.5,  # LOWER quantile boundary
quantile_U = 0.99, # UPPER quantile boundary
dens_L     = 0.01, # Target amount of density below LOWER quantile boundary
dens_U     = 0.01) # Target amount of density above UPPER quantile boundary
result = util$findParams(dist='beta', targets)
result$params
result$quantiles
util$makeHistogram(result, targets)
targets = list(
quantile_L = 1,    # LOWER quantile boundary
quantile_U = 10,   # UPPER quantile boundary
dens_L     = 0.01, # Target amount of density below LOWER quantile boundary
dens_U     = 0.01) # Target amount of density above UPPER quantile boundary
result = util$findParams(dist='inv_gamma', targets)
result$params
result$quantiles
util$makeHistogram(result, targets)
